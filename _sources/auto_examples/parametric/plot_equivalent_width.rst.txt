
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/parametric/plot_equivalent_width.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_parametric_plot_equivalent_width.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_parametric_plot_equivalent_width.py:


Plot equivalent width for UV indices
====================================

Example for generating the equivalent width for a set of UV indices from a parametric galaxy
- build a parametric galaxy (see make_sfzh)
- calculate equivalent width (see sed.py)

.. GENERATED FROM PYTHON SOURCE LINES 9-111



.. image-sg:: /auto_examples/parametric/images/sphx_glr_plot_equivalent_width_001.png
   :alt: F1370, F1400, F1425, F1460, UV_1501, F1533, F1550, UV_1719, F1853
   :srcset: /auto_examples/parametric/images/sphx_glr_plot_equivalent_width_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
    /home/runner/work/synthesizer/synthesizer/examples/parametric/plot_equivalent_width.py:97: UserWarning: The figure layout has changed to tight
      plt.tight_layout()
    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    /opt/hostedtoolcache/Python/3.10.12/x64/lib/python3.10/site-packages/numpy/core/fromnumeric.py:3504: RuntimeWarning: Mean of empty slice.
      return _methods._mean(a, axis=axis, dtype=dtype,
    /opt/hostedtoolcache/Python/3.10.12/x64/lib/python3.10/site-packages/numpy/core/_methods.py:129: RuntimeWarning: invalid value encountered in scalar divide
      ret = ret.dtype.type(ret / rcount)
    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]






|

.. code-block:: default


    import matplotlib.pyplot as plt

    from synthesizer.grid import Grid
    from synthesizer.parametric.sfzh import SFH, ZH, generate_sfzh
    from synthesizer.parametric.galaxy import Galaxy as Galaxy
    from synthesizer.sed import uv_indices
    from unyt import yr, Myr


    def get_ew(index, Z, smass, grid, EqW, mode):
        sfh_p = {"duration": 100 * Myr}

        Z_p = {"Z": Z}  # can also use linear metallicity e.g. {'Z': 0.01}
        stellar_mass = smass

        # --- define the functional form of the star formation and metal enrichment histories
        sfh = SFH.Constant(sfh_p)  # constant star formation
        print(sfh)  # print sfh summary

        Zh = ZH.deltaConstant(Z_p)  # constant metallicity

        # --- get 2D star formation and metal enrichment history for the given SPS grid. This is (age, Z).
        sfzh = generate_sfzh(
            grid.log10age, grid.metallicity, sfh, Zh, stellar_mass=stellar_mass
        )

        # --- create a galaxy object
        galaxy = Galaxy(sfzh)

        # --- generate equivalent widths
        if mode == 0:
            galaxy.get_spectra_incident(grid)
        else:
            galaxy.get_spectra_intrinsic(grid, fesc=0.5)

        EqW.append(galaxy.get_equivalent_width(index))
        return EqW


    def equivalent_width(grids, index, index_uv):
        # -- Calculate the equivalent width for each defined index
        for i, idx in enumerate(index):
            grid = Grid(grids, grid_dir=grid_dir)

            # --- define the parameters of the star formation and metal enrichment histories
            Z = grid.metallicity
            stellar_mass = 1e8
            EqW = []

            # Compute each index for each metallicity in the grid.
            for k in range(0, len(Z)):
                EqW = get_ew(idx, Z[k], stellar_mass, grid, EqW, 0)

            print(EqW)

            # Configure plot figure
            plt.rcParams["figure.dpi"] = 200
            plt.subplot(3, 3, i + 1)
            plt.grid(True)

            if i == 0 or i == 3 or i == 6:
                plt.ylabel("EW (\u212B)", fontsize=8)
            if i > 5:
                plt.xlabel("Z", fontsize=8)

            if index_uv[i] == 1501 or index_uv[i] == 1719:
                label = "UV_" + str(index_uv[i])
            else:
                label = "F" + str(index_uv[i])

            _, y_max = plt.ylim()

            plt.title(label, fontsize=8, transform=plt.gca().transAxes, y=0.8)

            plt.scatter(
                grid.metallicity,
                EqW,
                color="white",
                edgecolors="grey",
                alpha=1.0,
                zorder=10,
                linewidth=0.5,
                s=10,
            )
            plt.semilogx(grid.metallicity, EqW, linewidth=0.75, color="grey")
            EqW.clear()

            plt.tight_layout()

            if i == len(index) - 1:
                plt.show()


    if __name__ == "__main__":
        grid_dir = "../../tests/test_grid"  # Change this directory to your own.
        grid_name = "test_grid"  # Change this to the appropriate .hdf5

        indices = uv_indices()  # Retrieve UV indices
        index = indices[:, 0]  # [i[0] for i in indices]

        equivalent_width(grid_name, indices, index)


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 6.196 seconds)


.. _sphx_glr_download_auto_examples_parametric_plot_equivalent_width.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example




    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_equivalent_width.py <plot_equivalent_width.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_equivalent_width.ipynb <plot_equivalent_width.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
