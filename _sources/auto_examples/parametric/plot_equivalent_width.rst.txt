
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/parametric/plot_equivalent_width.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_parametric_plot_equivalent_width.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_parametric_plot_equivalent_width.py:


Plot equivalent width for UV indices
====================================

Example for generating the equivalent width for a set of UV indices from a parametric galaxy
- build a parametric galaxy (see make_sfzh)
- calculate equivalent width (see sed.py)

.. GENERATED FROM PYTHON SOURCE LINES 9-167



.. image-sg:: /auto_examples/parametric/images/sphx_glr_plot_equivalent_width_001.png
   :alt: F1370, F1400, F1425, F1460, UV_1501, F1533, F1550, UV_1719, F1853
   :srcset: /auto_examples/parametric/images/sphx_glr_plot_equivalent_width_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    [unyt_quantity(-0.00275086, 'Å'), unyt_quantity(0.09390815, 'Å'), unyt_quantity(0.52523083, 'Å'), unyt_quantity(0.77113254, 'Å'), unyt_quantity(0.93812704, 'Å'), unyt_quantity(1.06569882, 'Å'), unyt_quantity(1.24621133, 'Å'), unyt_quantity(1.33141954, 'Å'), unyt_quantity(1.41630711, 'Å'), unyt_quantity(1.57167506, 'Å'), unyt_quantity(1.67018234, 'Å'), unyt_quantity(1.77080309, 'Å'), unyt_quantity(1.86249268, 'Å')]
    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    [unyt_quantity(0.05800958, 'Å'), unyt_quantity(0.13988316, 'Å'), unyt_quantity(0.67669539, 'Å'), unyt_quantity(1.25238251, 'Å'), unyt_quantity(1.81546246, 'Å'), unyt_quantity(1.92028634, 'Å'), unyt_quantity(2.57231323, 'Å'), unyt_quantity(2.96206753, 'Å'), unyt_quantity(2.55963205, 'Å'), unyt_quantity(3.73256221, 'Å'), unyt_quantity(4.74254306, 'Å'), unyt_quantity(5.5579382, 'Å'), unyt_quantity(4.83197629, 'Å')]
    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    [unyt_quantity(0.00077882, 'Å'), unyt_quantity(0.06632751, 'Å'), unyt_quantity(0.42643354, 'Å'), unyt_quantity(0.58097093, 'Å'), unyt_quantity(0.66995994, 'Å'), unyt_quantity(0.74319503, 'Å'), unyt_quantity(0.85845703, 'Å'), unyt_quantity(0.93557034, 'Å'), unyt_quantity(1.00045425, 'Å'), unyt_quantity(0.98666206, 'Å'), unyt_quantity(1.06289314, 'Å'), unyt_quantity(1.23354611, 'Å'), unyt_quantity(1.36643019, 'Å')]
    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    [unyt_quantity(0.00492666, 'Å'), unyt_quantity(0.02989253, 'Å'), unyt_quantity(0.17404293, 'Å'), unyt_quantity(0.27479538, 'Å'), unyt_quantity(0.35513129, 'Å'), unyt_quantity(0.47967666, 'Å'), unyt_quantity(0.57042796, 'Å'), unyt_quantity(0.67728061, 'Å'), unyt_quantity(0.72784846, 'Å'), unyt_quantity(0.78208557, 'Å'), unyt_quantity(0.89086288, 'Å'), unyt_quantity(1.01446456, 'Å'), unyt_quantity(1.05057628, 'Å')]
    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    [unyt_quantity(0.0203133, 'Å'), unyt_quantity(0.07101963, 'Å'), unyt_quantity(0.24095127, 'Å'), unyt_quantity(0.36433179, 'Å'), unyt_quantity(0.47350339, 'Å'), unyt_quantity(0.55489359, 'Å'), unyt_quantity(0.67849859, 'Å'), unyt_quantity(0.78262172, 'Å'), unyt_quantity(0.87451307, 'Å'), unyt_quantity(1.01007787, 'Å'), unyt_quantity(1.17074687, 'Å'), unyt_quantity(1.27628762, 'Å'), unyt_quantity(1.25641705, 'Å')]
    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    [unyt_quantity(0.01108756, 'Å'), unyt_quantity(0.03183861, 'Å'), unyt_quantity(0.1733014, 'Å'), unyt_quantity(0.27924018, 'Å'), unyt_quantity(0.36491751, 'Å'), unyt_quantity(0.4910816, 'Å'), unyt_quantity(0.64060117, 'Å'), unyt_quantity(0.87046542, 'Å'), unyt_quantity(0.9543254, 'Å'), unyt_quantity(1.20244072, 'Å'), unyt_quantity(1.5033167, 'Å'), unyt_quantity(1.56964304, 'Å'), unyt_quantity(1.71471817, 'Å')]
    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    [unyt_quantity(0.23581235, 'Å'), unyt_quantity(0.48759582, 'Å'), unyt_quantity(1.93900494, 'Å'), unyt_quantity(2.77531332, 'Å'), unyt_quantity(3.39197025, 'Å'), unyt_quantity(3.8042223, 'Å'), unyt_quantity(4.44013522, 'Å'), unyt_quantity(4.84111281, 'Å'), unyt_quantity(4.99772369, 'Å'), unyt_quantity(5.4599069, 'Å'), unyt_quantity(5.54319291, 'Å'), unyt_quantity(5.90020451, 'Å'), unyt_quantity(6.24851378, 'Å')]
    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    [unyt_quantity(0.01553081, 'Å'), unyt_quantity(0.18137288, 'Å'), unyt_quantity(0.70637178, 'Å'), unyt_quantity(0.99673035, 'Å'), unyt_quantity(1.18279848, 'Å'), unyt_quantity(1.36703542, 'Å'), unyt_quantity(1.61452738, 'Å'), unyt_quantity(1.81757544, 'Å'), unyt_quantity(1.96645359, 'Å'), unyt_quantity(2.11518316, 'Å'), unyt_quantity(2.31018458, 'Å'), unyt_quantity(2.52774198, 'Å'), unyt_quantity(2.68255636, 'Å')]
    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    ----------
    SUMMARY OF PARAMETERISED STAR FORMATION HISTORY
    <class 'synthesizer.parametric.sfzh.SFH.Constant'>
    duration: 100 Myr
    median age: 50.00 Myr
    mean age: 50.00 Myr
    ----------

    [unyt_quantity(0.003234, 'Å'), unyt_quantity(0.06094212, 'Å'), unyt_quantity(0.36382144, 'Å'), unyt_quantity(0.53494039, 'Å'), unyt_quantity(0.65304873, 'Å'), unyt_quantity(0.73213422, 'Å'), unyt_quantity(0.88618704, 'Å'), unyt_quantity(0.98590307, 'Å'), unyt_quantity(1.09289749, 'Å'), unyt_quantity(1.21002093, 'Å'), unyt_quantity(1.37663092, 'Å'), unyt_quantity(1.61252444, 'Å'), unyt_quantity(1.78478025, 'Å')]






|

.. code-block:: default


    import matplotlib.pyplot as plt

    from synthesizer.grid import Grid
    from synthesizer.parametric.sfzh import SFH, ZH, generate_sfzh
    from synthesizer.parametric.galaxy import Galaxy as Galaxy
    from synthesizer.sed import Sed
    from unyt import yr, Myr


    def set_index():
        """
        A function to define a dictionary of uv indices.

        Each index has a defined absorption window.
        A pseudo-continuum is defined, made up of a blue and red shifted window.

        Returns:
            tuple: A tuple containing the following lists:
                - index (int): List of UV indices.
                - index_window (int): List of absorption window bounds.
                - blue_window (int): List of blue shifted window bounds.
                - red_window (int): List of red shifted window bounds.
        """

        index = [1370, 1400, 1425, 1460, 1501, 1533, 1550, 1719, 1853]
        index_window = [[1360, 1380], [1385, 1410], [1413, 1435], [1450, 1470], [1496, 1506], [1530, 1537], [1530, 1560], [1705, 1729], [1838, 1858]]
        blue_window = [[1345, 1354], [1345, 1354], [1345, 1354], [1436, 1447], [1482, 1491], [1482, 1491], [1482, 1491], [1675, 1684], [1797, 1807]]
        red_window = [[1436, 1447], [1436, 1447], [1436, 1447], [1482, 1491], [1583, 1593], [1583, 1593], [1583, 1593], [1751, 1761], [1871, 1883]]

        return index, index_window, blue_window, red_window


    def get_ew(index, feature, blue, red, Z, smass, grid, EqW, mode):
        """
        Calculate equivalent width for a specified UV index.

        Args:
            index (int): The UV index for which the equivalent width is calculated.
            Z (float): Metallicity.
            smass (float): Stellar mass.
            grid (Grid): The grid object.
            EqW (float): Initial equivalent width.
            mode (str): Calculation mode.

        Returns:
            float: The calculated equivalent width.

        Raises:
            ValueError: If mode is invalid.
        """
    
        sfh_p = {"duration": 100 * Myr}

        Z_p = {"Z": Z}  # can also use linear metallicity e.g. {'Z': 0.01}
        stellar_mass = smass

        # --- define the functional form of the star formation and metal enrichment histories
        sfh = SFH.Constant(sfh_p)  # constant star formation
        print(sfh)  # print sfh summary

        Zh = ZH.deltaConstant(Z_p)  # constant metallicity

        # --- get 2D star formation and metal enrichment history for the given SPS grid. This is (age, Z).
        sfzh = generate_sfzh(
            grid.log10age, grid.metallicity, sfh, Zh, stellar_mass=stellar_mass
        )

        # --- create a galaxy object
        galaxy = Galaxy(sfzh)

        # --- generate equivalent widths
        if mode == 0:
            galaxy.get_spectra_incident(grid)
        else:
            galaxy.get_spectra_intrinsic(grid, fesc=0.5)

        EqW.append(galaxy.get_equivalent_width(feature, blue, red))
        return EqW


    def equivalent_width(grids, uv_index, index_window, blue_window, red_window):
        """
        Calculate equivalent widths for specified UV indices.

        Args:
            grids (str): Grid name.
            uv_index (list): List of UV indices to calculate equivalent widths for.
            index_window (list): List of index window bounds.
            blue_window (list): List of blue shifted window bounds.
            red_window (list): List of red shifted window bounds.

        Returns:
            None
        """
    
        # -- Calculate the equivalent width for each defined index
        for i, index in enumerate(uv_index):
            grid = Grid(grids, grid_dir=grid_dir)

            # --- define the parameters of the star formation and metal enrichment histories
            Z = grid.metallicity
            stellar_mass = 1e8
            EqW = []

            # Compute each index for each metallicity in the grid.
            feature, blue, red = index_window[i], blue_window[i], red_window[i]

            for k in range(0, len(Z)):
                EqW = get_ew(index, feature, blue, red, Z[k], stellar_mass, grid, EqW, 0)

            print(EqW)

            # Configure plot figure
            plt.rcParams["figure.dpi"] = 200
            plt.subplot(3, 3, i + 1)
            plt.grid(True)

            if i == 0 or i == 3 or i == 6:
                plt.ylabel("EW (\u212B)", fontsize=8)
            if i > 5:
                plt.xlabel("Z", fontsize=8)

            if index == 1501 or index == 1719:
                label = "UV_" + str(index)
            else:
                label = "F" + str(index)

            _, y_max = plt.ylim()

            plt.title(label, fontsize=8, transform=plt.gca().transAxes, y=0.8)

            plt.scatter(
                grid.metallicity,
                EqW,
                color="white",
                edgecolors="grey",
                alpha=1.0,
                zorder=10,
                linewidth=0.5,
                s=10,
            )
            plt.semilogx(grid.metallicity, EqW, linewidth=0.75, color="grey")
            EqW.clear()

            plt.tight_layout()

            if i == len(uv_index) - 1:
                plt.show()


    if __name__ == "__main__":
        grid_dir = "../../tests/test_grid"  # Change this directory to your own.
        grid_name = "test_grid"  # Change this to the appropriate .hdf5

        index, index_window, blue_window, red_window = set_index()  # Retrieve UV indices

        equivalent_width(grid_name, index, index_window, blue_window, red_window)


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 43.110 seconds)


.. _sphx_glr_download_auto_examples_parametric_plot_equivalent_width.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example




    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_equivalent_width.py <plot_equivalent_width.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_equivalent_width.ipynb <plot_equivalent_width.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
