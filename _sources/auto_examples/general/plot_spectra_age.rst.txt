
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/general/plot_spectra_age.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_general_plot_spectra_age.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_general_plot_spectra_age.py:


Plot Spectra by age
===================

Plot all spectra in a grid by their age, for a given metallicity

.. GENERATED FROM PYTHON SOURCE LINES 7-71



.. image-sg:: /auto_examples/general/images/sphx_glr_plot_spectra_age_001.png
   :alt: plot spectra age
   :srcset: /auto_examples/general/images/sphx_glr_plot_spectra_age_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    closest metallicity: -2.00
    /home/runner/work/synthesizer/synthesizer/examples/general/plot_spectra_age.py:46: RuntimeWarning: divide by zero encountered in log10
      np.log10(grid.lam), np.log10(Lnu), c=cmap(norm(log10age)), lw=1, alpha=0.8
    No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.






|

.. code-block:: default


    from synthesizer.utils import fnu_to_flam
    from synthesizer.grid import Grid
    import numpy as np
    import matplotlib as mpl
    import matplotlib.pyplot as plt
    import matplotlib.cm as cm
    import cmasher as cmr


    def plot_spectra_age(grid, log10Z=-2.0, spec_name="incident"):
        cmap = cmr.bubblegum
        norm = mpl.colors.Normalize(vmin=5.0, vmax=11.0)

        iZ = grid.get_nearest_index(log10Z, grid.metallicity)
        print(f"closest metallicity: {log10Z:.2f}")

        fig = plt.figure(figsize=(3.5, 5.0))

        left = 0.15
        height = 0.8
        bottom = 0.1
        width = 0.8

        ax = fig.add_axes((left, bottom, width, height))

        cax = fig.add_axes((left, bottom + height, width, 0.02))

        cbar = fig.colorbar(
            cm.ScalarMappable(norm=norm, cmap=cmap), cax=cax, orientation="horizontal"
        )  # add the colourbar
        cax.xaxis.tick_top()
        cax.xaxis.set_label_position("top")
        cax.set_xlabel(r"$\rm \log_{10}(age/yr)$")

        for ia, log10age in enumerate(grid.log10age):
            Lnu = grid.spectra[spec_name][ia, iZ, :]
            # Lnu = fnu_to_flam(grid.lam, Lnu)
            ax.plot(
                np.log10(grid.lam), np.log10(Lnu), c=cmap(norm(log10age)), lw=1, alpha=0.8
            )

        for wv in [912.0, 3646.0]:
            ax.axvline(np.log10(wv), c="k", lw=1, alpha=0.5)

        ax.set_xlim([2.0, 4.0])
        ax.set_ylim([10.0, 22])
        ax.legend(fontsize=5, labelspacing=0.0)
        ax.set_xlabel(r"$\rm log_{10}(\lambda/\AA)$")
        ax.set_ylabel(r"$\rm log_{10}(L_{\nu}/erg\ s^{-1}\ Hz^{-1} M_{\odot}^{-1})$")

        return fig, ax


    if __name__ == "__main__":
        grid_dir = "../../tests/test_grid"
        grid_name = "test_grid"

        grid = Grid(grid_name, grid_dir=grid_dir)
        log10Z = -2.0

        fig, ax = plot_spectra_age(grid, log10Z=log10Z)
        plt.show()
        # fig.savefig(f'figs/spectra_age_{sps_name}.pdf')


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.232 seconds)


.. _sphx_glr_download_auto_examples_general_plot_spectra_age.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example




    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_spectra_age.py <plot_spectra_age.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_spectra_age.ipynb <plot_spectra_age.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
