
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/grids/plot_spectra.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_grids_plot_spectra.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_grids_plot_spectra.py:


Plot spectra example
====================

This example demonstrates how to extract a spectra directly from a grid and
plots all the available spectra.

NOTE: this only works on 2D grids at the moment

.. GENERATED FROM PYTHON SOURCE LINES 10-94



.. image-sg:: /auto_examples/grids/images/sphx_glr_plot_spectra_001.png
   :alt: plot spectra
   :srcset: /auto_examples/grids/images/sphx_glr_plot_spectra_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    +-------------------------------------------------------------------------------+
    |                                      SED                                      |
    +-------------+-----------------------------------------------------------------+
    | Attribute   | Value                                                           |
    +-------------+-----------------------------------------------------------------+
    | redshift    | 0                                                               |
    +-------------+-----------------------------------------------------------------+
    | lam (9244,) | 1.30e-04 Å -> 2.99e+11 Å (Mean: 9.73e+09 Å)                     |
    +-------------+-----------------------------------------------------------------+
    | nu (9244,)  | 1.00e+07 Hz -> 2.31e+22 Hz (Mean: 8.51e+19 Hz)                  |
    +-------------+-----------------------------------------------------------------+
    | lnu (9244,) | 0.00e+00 erg/(Hz*s) -> 3.10e+21 erg/(Hz*s) (Mean: 9.16e+19 erg) |
    +-------------+-----------------------------------------------------------------+
    /opt/hostedtoolcache/Python/3.10.15/x64/lib/python3.10/site-packages/unyt/array.py:1824: RuntimeWarning: divide by zero encountered in log10
      out_arr = func(np.asarray(inp), out=out_func, **kwargs)
    +-------------------------------------------------------------------------------+
    |                                      SED                                      |
    +-------------+-----------------------------------------------------------------+
    | Attribute   | Value                                                           |
    +-------------+-----------------------------------------------------------------+
    | redshift    | 0                                                               |
    +-------------+-----------------------------------------------------------------+
    | lam (9244,) | 1.30e-04 Å -> 2.99e+11 Å (Mean: 9.73e+09 Å)                     |
    +-------------+-----------------------------------------------------------------+
    | nu (9244,)  | 1.00e+07 Hz -> 2.31e+22 Hz (Mean: 8.51e+19 Hz)                  |
    +-------------+-----------------------------------------------------------------+
    | lnu (9244,) | 0.00e+00 erg/(Hz*s) -> 2.58e+24 erg/(Hz*s) (Mean: 6.81e+20 erg) |
    +-------------+-----------------------------------------------------------------+
    +-------------------------------------------------------------------------------+
    |                                      SED                                      |
    +-------------+-----------------------------------------------------------------+
    | Attribute   | Value                                                           |
    +-------------+-----------------------------------------------------------------+
    | redshift    | 0                                                               |
    +-------------+-----------------------------------------------------------------+
    | lam (9244,) | 1.30e-04 Å -> 2.99e+11 Å (Mean: 9.73e+09 Å)                     |
    +-------------+-----------------------------------------------------------------+
    | nu (9244,)  | 1.00e+07 Hz -> 2.31e+22 Hz (Mean: 8.51e+19 Hz)                  |
    +-------------+-----------------------------------------------------------------+
    | lnu (9244,) | 0.00e+00 erg/(Hz*s) -> 2.74e+24 erg/(Hz*s) (Mean: 8.27e+21 erg) |
    +-------------+-----------------------------------------------------------------+
    +-------------------------------------------------------------------------------+
    |                                      SED                                      |
    +-------------+-----------------------------------------------------------------+
    | Attribute   | Value                                                           |
    +-------------+-----------------------------------------------------------------+
    | redshift    | 0                                                               |
    +-------------+-----------------------------------------------------------------+
    | lam (9244,) | 1.30e-04 Å -> 2.99e+11 Å (Mean: 9.73e+09 Å)                     |
    +-------------+-----------------------------------------------------------------+
    | nu (9244,)  | 1.00e+07 Hz -> 2.31e+22 Hz (Mean: 8.51e+19 Hz)                  |
    +-------------+-----------------------------------------------------------------+
    | lnu (9244,) | 0.00e+00 erg/(Hz*s) -> 2.45e+21 erg/(Hz*s) (Mean: 5.94e+19 erg) |
    +-------------+-----------------------------------------------------------------+
    +-------------------------------------------------------------------------------+
    |                                      SED                                      |
    +-------------+-----------------------------------------------------------------+
    | Attribute   | Value                                                           |
    +-------------+-----------------------------------------------------------------+
    | redshift    | 0                                                               |
    +-------------+-----------------------------------------------------------------+
    | lam (9244,) | 1.30e-04 Å -> 2.99e+11 Å (Mean: 9.73e+09 Å)                     |
    +-------------+-----------------------------------------------------------------+
    | nu (9244,)  | 1.00e+07 Hz -> 2.31e+22 Hz (Mean: 8.51e+19 Hz)                  |
    +-------------+-----------------------------------------------------------------+
    | lnu (9244,) | 0.00e+00 erg/(Hz*s) -> 2.74e+24 erg/(Hz*s) (Mean: 8.32e+21 erg) |
    +-------------+-----------------------------------------------------------------+
    +-------------------------------------------------------------------------------+
    |                                      SED                                      |
    +-------------+-----------------------------------------------------------------+
    | Attribute   | Value                                                           |
    +-------------+-----------------------------------------------------------------+
    | redshift    | 0                                                               |
    +-------------+-----------------------------------------------------------------+
    | lam (9244,) | 1.30e-04 Å -> 2.99e+11 Å (Mean: 9.73e+09 Å)                     |
    +-------------+-----------------------------------------------------------------+
    | nu (9244,)  | 1.00e+07 Hz -> 2.31e+22 Hz (Mean: 8.51e+19 Hz)                  |
    +-------------+-----------------------------------------------------------------+
    | lnu (9244,) | 0.00e+00 erg/(Hz*s) -> 1.82e+23 erg/(Hz*s) (Mean: 7.58e+21 erg) |
    +-------------+-----------------------------------------------------------------+






|

.. code-block:: Python


    import argparse

    import matplotlib.pyplot as plt
    import numpy as np

    from synthesizer.grid import Grid

    if __name__ == "__main__":
        # Get the location of this script, __file__ is the absolute path of this
        # script, however we just want to directory
        # script_path = os.path.abspath(os.path.dirname(__file__))

        # define the test grid dir
        # test_grid_dir = script_path + "/../../tests/test_grid/"
        test_grid_dir = "../../tests/test_grid/"

        # initialise argument parser
        parser = argparse.ArgumentParser(
            description=(
                "Create a plot of all spectra types for a given metallicity and \
                age"
            )
        )

        # The name of the grid. Defaults to the test grid.
        parser.add_argument(
            "-grid_name",
            "--grid_name",
            type=str,
            required=False,
            default="test_grid",
        )

        # The path to the grid directory. Defaults to the test grid directory.
        parser.add_argument(
            "-grid_dir",
            "--grid_dir",
            type=str,
            required=False,
            default=test_grid_dir,
        )

        # The target metallicity. The code function will find the closest
        # metallicity and report it back. The rationale behind this is
        # that this code can easily be adapted to explore other grids.
        parser.add_argument(
            "-metallicity", type=float, required=False, default=0.01
        )

        # The target log10(age/yr). The code function will find the closest
        # metallicity and report it back. The rationale behind this is that
        # this code can easily be adapted to explore other grids.
        parser.add_argument("-log10age", type=float, required=False, default=6.0)

        # Get dictionary of arguments
        args = parser.parse_args()

        # initialise grid
        grid = Grid(args.grid_name, grid_dir=args.grid_dir)

        # get the grid point for this log10age and metallicity
        grid_point = grid.get_grid_point((args.log10age, args.metallicity))

        # loop over available spectra and plot
        for spec_name in grid.available_spectra:
            # get Sed object
            sed = grid.get_spectra(grid_point, spectra_id=spec_name)
            # print summary of SED object
            print(sed)
            plt.plot(
                np.log10(sed.lam),
                np.log10(sed.lnu),
                lw=1,
                alpha=0.8,
                label=spec_name,
            )

        plt.xlim([2.0, 4.0])
        plt.ylim([18.0, 23])
        plt.legend(fontsize=8, labelspacing=0.0)
        plt.xlabel(r"$\rm log_{10}(\lambda/\AA)$")
        plt.ylabel(r"$\rm log_{10}(L_{\nu}/erg\ s^{-1}\ Hz^{-1} M_{\odot}^{-1})$")
        plt.show()


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.434 seconds)


.. _sphx_glr_download_auto_examples_grids_plot_spectra.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_spectra.ipynb <plot_spectra.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_spectra.py <plot_spectra.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_spectra.zip <plot_spectra.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
