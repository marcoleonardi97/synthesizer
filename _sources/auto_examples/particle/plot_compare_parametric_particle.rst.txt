
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/particle/plot_compare_parametric_particle.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_particle_plot_compare_parametric_particle.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_particle_plot_compare_parametric_particle.py:


Compare parametric and particle SEDs
=====================================

This example compares a sampled and binned (parametric) SED for different numbers of particles

.. GENERATED FROM PYTHON SOURCE LINES 7-80



.. image-sg:: /auto_examples/particle/images/sphx_glr_plot_compare_parametric_particle_001.png
   :alt: plot compare parametric particle
   :srcset: /auto_examples/particle/images/sphx_glr_plot_compare_parametric_particle_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /opt/hostedtoolcache/Python/3.10.13/x64/lib/python3.10/site-packages/unyt/array.py:1813: RuntimeWarning: divide by zero encountered in log10
      out_arr = func(np.asarray(inp), out=out_func, **kwargs)






|

.. code-block:: Python


    import os
    import numpy as np
    import matplotlib.pyplot as plt
    from unyt import yr, Myr

    from synthesizer.grid import Grid
    from synthesizer.parametric import SFH, ZDist
    from synthesizer.parametric import Stars as ParametricStars
    from synthesizer.particle.stars import sample_sfhz
    from synthesizer.parametric.galaxy import Galaxy as ParametricGalaxy
    from synthesizer.particle.galaxy import Galaxy as ParticleGalaxy


    # Define the grid
    grid_name = "test_grid"
    grid_dir = "../../tests/test_grid/"
    grid = Grid(grid_name, grid_dir=grid_dir)

    # Define the SFH and metallicity distribution
    Z_p = {"metallicity": 0.01}
    metal_dist = ZDist.DeltaConstant(**Z_p)
    sfh_p = {"duration": 100 * Myr}
    sfh = SFH.Constant(**sfh_p)

    # Define the parametric stars
    sfzh = ParametricStars(
        grid.log10age,
        grid.metallicity,
        sf_hist=sfh,
        metal_dist=metal_dist,
        initial_mass=1,
    )

    # Compute the parametric sed
    parametric_galaxy = ParametricGalaxy(sfzh)
    parametric_galaxy.stars.get_spectra_incident(grid)
    sed = parametric_galaxy.stars.spectra["incident"]
    plt.plot(
        np.log10(sed.lam), np.log10(sed.lnu), label="parametric", lw=4, c="k", alpha=0.3
    )


    # Compute the particle Sed for a range of particle samples
    for nstar in [1, 10, 100, 1000]:
        # Get the stars object
        stars = sample_sfhz(
            sfzh.sfzh,
            sfzh.log10ages,
            sfzh.log10metallicities,
            nstar,
            initial_mass=1 / nstar,
        )

        # Get the particle galaxy
        particle_galaxy = ParticleGalaxy(stars=stars)

        # Calculate the stars SEDs using nearest grid point
        ngp_sed = particle_galaxy.stars.get_spectra_incident(
            grid, grid_assignment_method="ngp"
        )

        plt.plot(
            np.log10(ngp_sed.lam),
            np.log10(ngp_sed.lnu),
            label=f"particle (N={nstar})",
        )


    plt.legend()
    plt.xlim([2, 5])
    plt.ylim([18, 22])
    plt.show()


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.165 seconds)


.. _sphx_glr_download_auto_examples_particle_plot_compare_parametric_particle.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_compare_parametric_particle.ipynb <plot_compare_parametric_particle.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_compare_parametric_particle.py <plot_compare_parametric_particle.py>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
