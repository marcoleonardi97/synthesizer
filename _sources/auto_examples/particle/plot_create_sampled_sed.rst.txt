
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/particle/plot_create_sampled_sed.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_particle_plot_create_sampled_sed.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_particle_plot_create_sampled_sed.py:


Create sampled SED
==================

this example generates a sample of star particles from a 2D SFZH.
In this case it is generated from a parametric star formation history
with constant star formation.

.. GENERATED FROM PYTHON SOURCE LINES 9-76



.. image-sg:: /auto_examples/particle/images/sphx_glr_plot_create_sampled_sed_001.png
   :alt: plot create sampled sed
   :srcset: /auto_examples/particle/images/sphx_glr_plot_create_sampled_sed_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    ----------
    SUMMARY OF BINNED SFZH
    median age: 50.12 Myr
    mean age: 50.01 Myr
    mean metallicity: 0.0100
    ----------

    /opt/hostedtoolcache/Python/3.10.13/x64/lib/python3.10/site-packages/unyt/array.py:1813: RuntimeWarning: divide by zero encountered in log10
      out_arr = func(np.asarray(inp), out=out_func, **kwargs)






|

.. code-block:: Python


    import numpy as np
    import matplotlib.pyplot as plt
    from unyt import Myr

    from synthesizer.grid import Grid
    from synthesizer.parametric import SFH, ZDist
    from synthesizer.parametric import Stars as ParametricStars
    from synthesizer.particle.stars import sample_sfhz
    from synthesizer.particle.galaxy import Galaxy


    # Define the grid
    grid_name = "test_grid"
    grid_dir = "../../tests/test_grid/"
    grid = Grid(grid_name, grid_dir=grid_dir)

    # define the grid (normally this would be defined by an SPS grid)
    log10ages = np.arange(6.0, 10.5, 0.1)
    metallicities = 10 ** np.arange(-5.0, -1.5, 0.1)

    # define the parameters of the star formation and metal enrichment histories

    Z_p = {"metallicity": 0.01}
    metal_dist = ZDist.DeltaConstant(**Z_p)

    sfh_p = {"duration": 100 * Myr}
    sfh = SFH.Constant(**sfh_p)  # constant star formation
    sfzh = ParametricStars(
        log10ages, metallicities, sf_hist=sfh, metal_dist=metal_dist
    )
    print(sfzh)
    # sfzh.plot()


    # --- create stars object

    N = 100  # number of particles for sampling
    stars = sample_sfhz(sfzh.sfzh, sfzh.log10ages, sfzh.log10metallicities, N)

    # --- create galaxy object

    galaxy = Galaxy(stars=stars)

    """ this generates stellar and intrinsic spectra
    galaxy.generate_intrinsic_spectra(grid, fesc=0.0)
    calculate only integrated SEDs """
    galaxy.stars.get_spectra_incident(grid)

    # --- generate dust screen
    # galaxy.get_screen(0.5) # tau_v

    # --- generate CF00 variable dust screen
    # galaxy.get_CF00(grid, 0.5, 0.5) # grid, tau_v_BC, tau_v_ISM

    # --- generate for los model
    # TODO: to be implemented
    # tau_vs = np.ones(N) * 0.5
    # galaxy.get_los(tau_vs)  # grid, tau_v_BC, tau_v_ISM

    for sed_type, sed in galaxy.stars.spectra.items():
        plt.plot(np.log10(sed.lam), np.log10(sed.lnu), label=sed_type)

    plt.legend()
    plt.xlim([2, 5])
    plt.ylim([10, 24])
    plt.show()


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.152 seconds)


.. _sphx_glr_download_auto_examples_particle_plot_create_sampled_sed.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_create_sampled_sed.ipynb <plot_create_sampled_sed.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_create_sampled_sed.py <plot_create_sampled_sed.py>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
